{
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/settings.json",
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## SOC Detection Summary\nThis workbook summarizes alerts generated by Sentinel Analytics Rules."
      },
      "name": "text - title"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "workspace",
            "name": "Workspace",
            "type": 6,
            "value": "/subscriptions/95f5b230-2ac0-46e4-9e78-213a57b19bda/resourceGroups/rg-shared-services/providers/Microsoft.OperationalInsights/workspaces/law-sec-ops",
            "resourceType": "microsoft.operationalinsights/workspaces",
            "required": true
          }
        ]
      },
      "name": "parameter - workspace"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlItem/1.0",
        "query": "SecurityAlert\n| summarize AlertCount=count(), FirstSeen=min(TimeGenerated), LastSeen=max(TimeGenerated) by AlertName, Severity, ProviderName\n| order by LastSeen desc",
        "size": 2,
        "exportFieldName": "AlertName",
        "queryType": 1,
        "querySource": 1,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "resource": "/subscriptions/95f5b230-2ac0-46e4-9e78-213a57b19bda/resourceGroups/rg-shared-services/providers/Microsoft.OperationalInsights/workspaces/law-sec-ops"
      },
      "name": "table - alert summary"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlItem/1.0",
        "query": "SecurityAlert\n| summarize Alerts=count() by bin(TimeGenerated, 1d), Severity\n| render timechart",
        "size": 1,
        "queryType": 1,
        "querySource": 1,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "resource": "/subscriptions/95f5b230-2ac0-46e4-9e78-213a57b19bda/resourceGroups/rg-shared-services/providers/Microsoft.OperationalInsights/workspaces/law-sec-ops"
      },
      "name": "chart - alert volume over time"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlItem/1.0",
        "query": "SecurityAlert\n| summarize Count=count() by Tactic=tostring(parse_json(ExtendedProperties).tactics)\n| order by Count desc",
        "size": 1,
        "queryType": 1,
        "querySource": 1,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "resource": "/subscriptions/95f5b230-2ac0-46e4-9e78-213a57b19bda/resourceGroups/rg-shared-services/providers/Microsoft.OperationalInsights/workspaces/law-sec-ops"
      },
      "name": "table - tactic distribution"
    }
  ]
}
